<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>نظام تسجيل وترشيح طالبات مسار السفر والسياحة | مدرسة خولة بنت حكيم</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;500;600;700;800&family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
  <link rel="icon" type="image/x-icon" href="https://d.top4top.io/p_36520q11g1.png">

  <style>
    :root {
      --primary-color: #0a5c36;
      --secondary-color: #2e8b57;
      --accent-color: #e63946;
      --gold-color: #d4af37;
      --dark-green: #0d3b1e;
      --text-color: #2d3748;
      --text-light: #4a5568;
      --white: #ffffff;
      --shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --border-radius: 12px;
      --border-radius-lg: 20px;
      --gradient-primary: linear-gradient(135deg, rgba(10, 92, 54, 0.95) 0%, rgba(13, 59, 30, 0.95) 100%);
      --gradient-secondary: linear-gradient(135deg, #2e8b57 0%, #1d6b3e 100%);
      --gradient-accent: linear-gradient(135deg, #e63946 0%, #c1121f 100%);
      --gradient-gold: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
      --gradient-light: linear-gradient(135deg, #f0f8f4 0%, #e8f5e9 100%);
      --glass-bg: rgba(255, 255, 255, 0.15);
      --glass-border: rgba(255, 255, 255, 0.25);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    html { scroll-behavior: smooth; overflow-x: hidden; }
    body {
      font-family: 'Tajawal', 'Noto Naskh Arabic', sans-serif;
      background: linear-gradient(135deg, #f0f8f4 0%, #e8f5e9 100%);
      color: var(--text-color);
      line-height: 1.7;
      overflow-x: hidden;
      min-height: 100vh;
      width: 100%;
      max-width: 100%;
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 0 18px; width: 100%; }

    /* إضافة الشعار المضيء */
    .logo-container {
      text-align: center;
      margin-bottom: 20px;
      animation: floatLogo 6s ease-in-out infinite;
    }

    .logo-img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid var(--gold-color);
      box-shadow: 
        0 0 30px rgba(212, 175, 55, 0.6),
        0 0 60px rgba(10, 92, 54, 0.4),
        inset 0 0 20px rgba(255, 255, 255, 0.3);
      transition: var(--transition);
      position: relative;
      z-index: 10;
    }

    .logo-img:hover {
      transform: scale(1.05);
      box-shadow: 
        0 0 40px rgba(212, 175, 55, 0.8),
        0 0 80px rgba(10, 92, 54, 0.6),
        inset 0 0 30px rgba(255, 255, 255, 0.5);
    }

    .logo-glow {
      position: absolute;
      width: 140px;
      height: 140px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(212, 175, 55, 0.3) 0%, rgba(10, 92, 54, 0.1) 70%);
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      animation: pulseGlow 4s ease-in-out infinite;
    }

    @keyframes floatLogo {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes pulseGlow {
      0%, 100% { opacity: 0.7; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    }

    header {
      background: var(--gradient-primary), url('https://d.top4top.io/p_36520q11g1.png') center/cover no-repeat;
      color: var(--white);
      padding: 30px 0 28px;
      text-align: center;
      border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
      margin-bottom: 34px;
      position: relative;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      overflow: hidden;
    }

    .header-content { padding: 0 12px; }
    
    h1 {
      font-size: clamp(1.8rem, 4.8vw, 3rem);
      font-weight: 800;
      line-height: 1.25;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #fff 0%, #e6ffe6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .header-subtitle {
      font-size: clamp(1.2rem, 3.2vw, 2rem);
      color: var(--gold-color);
      font-weight: 800;
      text-shadow: 0 2px 8px rgba(0,0,0,0.25);
      margin: 10px 0 14px;
    }

    .header-meta {
      display: inline-block;
      font-size: clamp(1rem, 2.2vw, 1.25rem);
      font-weight: 700;
      padding: 12px 22px;
      border-radius: 999px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
      max-width: 95%;
    }

    /* العد التنازلي */
    .countdown-container {
      margin: 25px auto 15px;
      max-width: 800px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--border-radius-lg);
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
    }

    .countdown-title {
      font-size: 1.4rem;
      font-weight: 800;
      color: var(--gold-color);
      margin-bottom: 15px;
      text-align: center;
    }

    .countdown-display {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .countdown-item {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      padding: 15px;
      min-width: 100px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .countdown-value {
      font-size: 2.5rem;
      font-weight: 900;
      color: white;
      display: block;
      line-height: 1;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    .countdown-label {
      font-size: 0.9rem;
      color: var(--gold-color);
      margin-top: 8px;
      font-weight: 600;
    }

    .registration-period {
      text-align: center;
      margin-top: 15px;
      font-size: 1.1rem;
      color: white;
      font-weight: 600;
    }

    .main-nav {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 18px;
      flex-wrap: wrap;
      padding: 0 10px;
    }
    .nav-btn {
      color: var(--white);
      border: 1px solid rgba(255,255,255,0.25);
      padding: 14px 18px;
      border-radius: 14px;
      font-size: 1.05rem;
      font-weight: 800;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: var(--transition);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.18);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      min-height: 52px;
      width: min(330px, 100%);
      position: relative;
      overflow: hidden;
    }
    
    .nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: 0.5s;
    }
    
    .nav-btn:hover::before {
      left: 100%;
    }
    
    .nav-btn:hover { 
      transform: translateY(-3px); 
      box-shadow: 0 14px 26px rgba(0,0,0,0.22);
    }
    
    .instructions-btn { 
      background: var(--gradient-secondary);
    }
    
    .register-btn { 
      background: var(--gradient-gold);
    }
    
    .admin-btn {
      background: linear-gradient(135deg, #8B0000 0%, #B22222 100%);
    }
    
    .status-btn {
      background: linear-gradient(135deg, #4682B4 0%, #5F9EA0 100%);
    }

    /* قسم التسجيل */
    .registration-container {
      background: var(--white);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow);
      padding: 30px;
      border: 1px solid rgba(0,0,0,0.06);
      width: 100%;
      max-width: 100%;
      margin-bottom: 50px;
      display: none;
    }

    .registration-container.active {
      display: block;
    }

    .form-title {
      color: var(--dark-green);
      font-size: 2rem;
      font-weight: 900;
      margin-bottom: 25px;
      text-align: center;
      padding-bottom: 15px;
      border-bottom: 3px solid var(--primary-color);
    }

    .form-section {
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(10, 92, 54, 0.05) 0%, rgba(46, 139, 87, 0.05) 100%);
      border-radius: var(--border-radius);
      border: 1px solid rgba(10, 92, 54, 0.1);
    }

    .section-title {
      color: var(--primary-color);
      font-size: 1.5rem;
      font-weight: 800;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      color: var(--gold-color);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 700;
      color: var(--dark-green);
      font-size: 1.05rem;
    }

    .form-label span {
      color: var(--accent-color);
    }

    .form-input, .form-select {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid rgba(10, 92, 54, 0.2);
      border-radius: 10px;
      font-size: 1rem;
      font-family: 'Tajawal', sans-serif;
      transition: var(--transition);
      background: white;
    }

    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(10, 92, 54, 0.1);
    }

    .radio-group {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 8px;
      transition: var(--transition);
      border: 1px solid rgba(10, 92, 54, 0.2);
      background: white;
    }

    .radio-option:hover {
      border-color: var(--primary-color);
      background: rgba(10, 92, 54, 0.05);
    }

    .radio-option input {
      margin: 0;
    }

    .radio-text {
      font-weight: 600;
    }

    .radio-points {
      font-weight: 800;
      color: var(--primary-color);
      margin-right: 5px;
    }

    /* أسئلة الميول */
    .tendency-question {
      margin-bottom: 25px;
      padding: 20px;
      background: white;
      border-radius: var(--border-radius);
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .question-text {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--dark-green);
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .points-info {
      display: inline-block;
      background: rgba(212, 175, 55, 0.1);
      color: var(--gold-color);
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 700;
      margin-top: 10px;
      border: 1px solid rgba(212, 175, 55, 0.3);
    }

    /* رفع الملف */
    .file-upload {
      position: relative;
      margin-top: 10px;
    }

    .file-input {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    .file-label {
      display: block;
      padding: 15px;
      background: white;
      border: 2px dashed rgba(10, 92, 54, 0.3);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
    }

    .file-label:hover {
      border-color: var(--primary-color);
      background: rgba(10, 92, 54, 0.05);
    }

    .file-label i {
      color: var(--primary-color);
      font-size: 1.5rem;
      margin-bottom: 10px;
      display: block;
    }

    .file-name {
      margin-top: 10px;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* شروط القبول */
    .conditions-list {
      padding-right: 20px;
      margin-bottom: 25px;
    }

    .condition-item {
      margin-bottom: 12px;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    .condition-item i {
      color: var(--secondary-color);
      margin-top: 3px;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 15px 0;
    }

    .checkbox-group input {
      width: 18px;
      height: 18px;
    }

    /* النتيجة */
    .result-container {
      background: var(--white);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow);
      padding: 30px;
      border: 1px solid rgba(0,0,0,0.06);
      width: 100%;
      max-width: 100%;
      margin-bottom: 50px;
      text-align: center;
      display: none;
    }

    .result-container.active {
      display: block;
    }

    .result-icon {
      font-size: 4rem;
      color: var(--secondary-color);
      margin-bottom: 20px;
    }

    .result-title {
      font-size: 2rem;
      font-weight: 900;
      color: var(--dark-green);
      margin-bottom: 15px;
    }

    .result-details {
      background: linear-gradient(135deg, rgba(10, 92, 54, 0.05) 0%, rgba(46, 139, 87, 0.05) 100%);
      border-radius: var(--border-radius);
      padding: 20px;
      margin: 20px 0;
      text-align: right;
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(0,0,0,0.08);
    }

    .result-item:last-child {
      border-bottom: none;
    }

    .result-label {
      font-weight: 700;
      color: var(--dark-green);
    }

    .result-value {
      font-weight: 800;
      color: var(--primary-color);
    }

    .result-status {
      font-size: 1.3rem;
      font-weight: 900;
      padding: 15px 30px;
      border-radius: 50px;
      display: inline-block;
      margin: 20px 0;
    }

    .status-accepted {
      background: rgba(46, 139, 87, 0.15);
      color: var(--secondary-color);
      border: 2px solid var(--secondary-color);
    }

    .status-waiting {
      background: rgba(212, 175, 55, 0.15);
      color: var(--gold-color);
      border: 2px solid var(--gold-color);
    }

    .result-note {
      color: var(--text-light);
      font-size: 1rem;
      margin-top: 20px;
      font-style: italic;
    }

    /* لوحة الإدارة */
    .admin-container {
      background: var(--white);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow);
      padding: 30px;
      border: 1px solid rgba(0,0,0,0.06);
      width: 100%;
      max-width: 100%;
      margin-bottom: 50px;
      display: none;
    }

    .admin-container.active {
      display: block;
    }

    .admin-panel {
      margin-top: 20px;
    }

    .admin-controls {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .search-box {
      flex: 1;
      min-width: 300px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 12px 45px 12px 16px;
      border: 2px solid rgba(10, 92, 54, 0.2);
      border-radius: 10px;
      font-size: 1rem;
    }

    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: var(--border-radius);
      padding: 20px;
      text-align: center;
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--primary-color);
      line-height: 1;
    }

    .stat-label {
      color: var(--text-light);
      margin-top: 10px;
      font-weight: 600;
    }

    .applications-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      min-width: 1000px;
    }

    .applications-table th {
      background: var(--gradient-primary);
      color: var(--white);
      padding: 15px;
      text-align: center;
      font-weight: 900;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .applications-table td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid rgba(0,0,0,0.08);
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 700;
      display: inline-block;
    }

    .badge-accepted {
      background: rgba(46, 139, 87, 0.15);
      color: var(--secondary-color);
    }

    .badge-waiting {
      background: rgba(212, 175, 55, 0.15);
      color: var(--gold-color);
    }

    .badge-excellent {
      background: rgba(70, 130, 180, 0.15);
      color: #4682B4;
    }

    /* المشرفات */
    .supervisors {
      text-align: center;
      margin-top: 30px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(10, 92, 54, 0.05) 0%, rgba(46, 139, 87, 0.05) 100%);
      border-radius: var(--border-radius);
    }

    .supervisors-title {
      color: var(--primary-color);
      font-size: 1.3rem;
      font-weight: 800;
      margin-bottom: 15px;
    }

    .supervisors-list {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    .supervisor {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--dark-green);
    }

    footer {
      text-align: center;
      padding: 36px 14px;
      background: var(--gradient-primary), url('https://d.top4top.io/p_36520q11g1.png') center/cover no-repeat;
      color: var(--white);
      border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
      box-shadow: 0 -10px 30px rgba(0,0,0,0.12);
      margin-top: 50px;
    }
    
    footer strong { color: var(--gold-color); }

    /* استجابية */
    @media (max-width: 768px) {
      .logo-img {
        width: 100px;
        height: 100px;
      }
      
      .logo-glow {
        width: 120px;
        height: 120px;
      }
      
      .countdown-item {
        min-width: 80px;
        padding: 12px;
      }
      
      .countdown-value {
        font-size: 2rem;
      }
      
      .registration-container, .result-container, .admin-container {
        padding: 20px 15px;
      }
      
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .applications-table {
        display: block;
        overflow-x: auto;
      }
      
      .search-box {
        min-width: 100%;
      }
      
      .admin-controls {
        flex-direction: column;
      }
      
      .supervisors-list {
        flex-direction: column;
        gap: 15px;
      }
    }

    /* Modals */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      inset: 0;
      background: rgba(0,0,0,0.78);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 12px;
    }
    
    .modal-content {
      background: white;
      width: min(900px, 100%);
      margin: 0 auto;
      border-radius: 20px;
      padding: 22px;
      max-height: 92vh;
      overflow: auto;
      position: relative;
      box-shadow: 0 25px 60px rgba(0,0,0,0.35);
    }
    
    .close {
      position: sticky;
      top: 0;
      float: left;
      width: 42px;
      height: 42px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      cursor: pointer;
      background: rgba(0,0,0,0.06);
      transition: var(--transition);
    }
    
    .close:hover { 
      background: var(--accent-color); 
      color: white; 
      transform: rotate(90deg);
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <!-- إضافة الشعار المضيء -->
      <div class="logo-container">
        <div class="logo-glow"></div>
        <img src="https://d.top4top.io/p_36520q11g1.png" alt="شعار المدرسة" class="logo-img">
      </div>
      
      <div class="header-content">
        <h1>نظام تسجيل وترشيح طالبات مسار السفر والسياحة</h1>
        <div class="header-subtitle">مدرسة خولة بنت حكيم للتعليم الأساسي</div>
        <div class="header-meta"> الفصل الدراسي الثاني - العام الدراسي 2025/2026</div>

        <!-- العد التنازلي للتسجيل -->
        <div class="countdown-container">
          <div class="countdown-title">
            <i class="fas fa-clock"></i> العد التنازلي لانتهاء فترة التسجيل
          </div>
          <div class="countdown-display">
            <div class="countdown-item">
              <span class="countdown-value" id="countdownDays">00</span>
              <span class="countdown-label">يوم</span>
            </div>
            <div class="countdown-item">
              <span class="countdown-value" id="countdownHours">00</span>
              <span class="countdown-label">ساعة</span>
            </div>
            <div class="countdown-item">
              <span class="countdown-value" id="countdownMinutes">00</span>
              <span class="countdown-label">دقيقة</span>
            </div>
            <div class="countdown-item">
              <span class="countdown-value" id="countdownSeconds">00</span>
              <span class="countdown-label">ثانية</span>
            </div>
          </div>
          <div class="registration-period">
            <i class="fas fa-calendar-alt"></i> فترة التسجيل مفتوحة من 25 يناير إلى 26 فبراير 2026
          </div>
        </div>

        <!-- المشرفات -->
        <div class="supervisors">
          <div class="supervisors-title">أخصائيات التوجيه المهني:</div>
          <div class="supervisors-list">
            <div class="supervisor">أ/ إيمان سعيد البهانتة</div>
            <div class="supervisor">أ/ فاطمة علي بيت سعيد</div>
          </div>
        </div>

        <div class="main-nav">
          <button class="nav-btn instructions-btn" id="instructionsBtn">
            <i class="fas fa-info-circle"></i>شروط وشروط التسجيل
          </button>
          <button class="nav-btn register-btn" id="registerBtn">
            <i class="fas fa-user-plus"></i>تقديم طلب التسجيل
          </button>
          <button class="nav-btn status-btn" id="statusBtn">
            <i class="fas fa-search"></i>الاستعلام عن حالة الطلب
          </button>
          <button class="nav-btn admin-btn" id="adminBtn">
            <i class="fas fa-lock"></i>لوحة الإدارة
          </button>
        </div>
      </div>
    </header>

    <!-- قسم التسجيل -->
    <div class="registration-container" id="registrationForm">
      <h2 class="form-title">تقديم طلب التسجيل في مسار السفر والسياحة</h2>
      
      <form id="studentRegistrationForm">
        <!-- البيانات الشخصية -->
        <div class="form-section">
          <h3 class="section-title"><i class="fas fa-user-graduate"></i> البيانات الشخصية</h3>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">الاسم الكامل للطالبة <span>*</span></label>
              <input type="text" class="form-input" id="studentName" required placeholder="أدخل الاسم الكامل">
            </div>
            <div class="form-group">
              <label class="form-label">الصف الدراسي <span>*</span></label>
              <select class="form-select" id="studentGrade" required>
                <option value="">اختر الصف</option>
                <option value="10">الصف العاشر</option>
                <option value="11">الصف الحادي عشر</option>
              </select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">الرقم المدني <span>*</span></label>
              <input type="text" class="form-input" id="civilId" required placeholder="أدخل الرقم المدني" maxlength="11">
            </div>
            <div class="form-group">
              <label class="form-label">رقم هاتف الطالبة <span>*</span></label>
              <input type="tel" class="form-input" id="studentPhone" required placeholder="أدخل رقم الهاتف">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">رقم هاتف ولي الأمر <span>*</span></label>
              <input type="tel" class="form-input" id="parentPhone" required placeholder="أدخل رقم ولي الأمر">
            </div>
            <div class="form-group">
              <label class="form-label">المنطقة السكنية <span>*</span></label>
              <input type="text" class="form-input" id="residentialArea" required placeholder="أدخل المنطقة السكنية">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">اسم ولي الأمر <span>*</span></label>
              <input type="text" class="form-input" id="parentName" required placeholder="أدخل اسم ولي الأمر">
            </div>
            <div class="form-group">
              <label class="form-label">علاقة ولي الأمر <span>*</span></label>
              <select class="form-select" id="parentRelation" required>
                <option value="">اختر العلاقة</option>
                <option value="الأب">الأب</option>
                <option value="الأم">الأم</option>
                <option value="الوصي">الوصي</option>
                <option value="أخ">أخ</option>
                <option value="أخرى">أخرى</option>
              </select>
            </div>
          </div>
        </div>

        <!-- أسئلة الميول -->
        <div class="form-section">
          <h3 class="section-title"><i class="fas fa-brain"></i> أسئلة الميول المهنية</h3>
          <p style="margin-bottom: 20px; color: var(--text-color); font-weight: 600; text-align: center; background: rgba(212, 175, 55, 0.1); padding: 12px; border-radius: 8px; border-right: 4px solid var(--gold-color);">
            <i class="fas fa-lightbulb"></i> أجيبي بكل صدق، لا توجد إجابة صحيحة أو خاطئة. كل إجابة تُحسب بنقاط: نعم = 2، أحيانًا = 1، لا = 0
          </p>
          
          <div class="tendency-question">
            <div class="question-text">1. هل تستمتعين بالتحدث مع أشخاص جدد والعمل معهم في فرق صغيرة أو كبيرة؟</div>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="q1" value="2" required>
                <span class="radio-text">نعم</span>
                <span class="radio-points">(2 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q1" value="1">
                <span class="radio-text">أحيانًا</span>
                <span class="radio-points">(1 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q1" value="0">
                <span class="radio-text">لا</span>
                <span class="radio-points">(0 نقطة)</span>
              </label>
            </div>
          </div>
          
          <div class="tendency-question">
            <div class="question-text">2. هل لديك رغبة في التعرف على ثقافات جديدة وزيارة أماكن سياحية مختلفة؟</div>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="q2" value="2" required>
                <span class="radio-text">نعم</span>
                <span class="radio-points">(2 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q2" value="1">
                <span class="radio-text">أحيانًا</span>
                <span class="radio-points">(1 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q2" value="0">
                <span class="radio-text">لا</span>
                <span class="radio-points">(0 نقطة)</span>
              </label>
            </div>
          </div>
          
          <div class="tendency-question">
            <div class="question-text">3. هل تحبين ترتيب وتنظيم الأنشطة، أو تخطيط الرحلات والفعاليات؟</div>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="q3" value="2" required>
                <span class="radio-text">نعم</span>
                <span class="radio-points">(2 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q3" value="1">
                <span class="radio-text">أحيانًا</span>
                <span class="radio-points">(1 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q3" value="0">
                <span class="radio-text">لا</span>
                <span class="radio-points">(0 نقطة)</span>
              </label>
            </div>
          </div>
          
          <div class="tendency-question">
            <div class="question-text">4. هل تستطيعين التعامل مع مواقف غير متوقعة أثناء تنظيم الرحلات أو استقبال الزوار؟</div>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="q4" value="2" required>
                <span class="radio-text">نعم</span>
                <span class="radio-points">(2 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q4" value="1">
                <span class="radio-text">أحيانًا</span>
                <span class="radio-points">(1 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q4" value="0">
                <span class="radio-text">لا</span>
                <span class="radio-points">(0 نقطة)</span>
              </label>
            </div>
          </div>
          
          <div class="tendency-question">
            <div class="question-text">5. هل تفضلين التعلم العملي والتطبيقي في الأنشطة والرحلات على التعلم النظري فقط؟</div>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="q5" value="2" required>
                <span class="radio-text">نعم</span>
                <span class="radio-points">(2 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q5" value="1">
                <span class="radio-text">أحيانًا</span>
                <span class="radio-points">(1 نقطة)</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="q5" value="0">
                <span class="radio-text">لا</span>
                <span class="radio-points">(0 نقطة)</span>
              </label>
            </div>
          </div>
        </div>

        <!-- مستوى اللغة الإنجليزية -->
        <div class="form-section">
          <h3 class="section-title"><i class="fas fa-language"></i> مستوى اللغة الإنجليزية</h3>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">درجة اللغة الإنجليزية في الفصل الأول <span>*</span></label>
              <input type="number" class="form-input" id="englishGrade" required min="0" max="100" placeholder="أدخل الدرجة من 0 إلى 100">
              <div class="points-info" style="margin-top: 10px;">
                <i class="fas fa-info-circle"></i> سيتم تحويل الدرجة إلى نقاط: 90-100 = 5 نقاط، 80-89 = 4 نقاط، 70-79 = 3 نقاط، 60-69 = 2 نقاط، 50-59 = 1 نقطة
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">رفع شهادة الفصل الأول (PDF أو صورة) <span>*</span></label>
              <div class="file-upload">
                <input type="file" class="file-input" id="certificateFile" accept=".pdf,.jpg,.jpeg,.png" required>
                <label for="certificateFile" class="file-label">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <span>انقر لرفع شهادة الفصل الأول</span>
                  <div class="file-name" id="fileName">لم يتم اختيار ملف</div>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- الشروط والتعهدات -->
        <div class="form-section">
          <h3 class="section-title"><i class="fas fa-file-contract"></i> الشروط والتعهدات</h3>
          
          <div class="conditions-list">
            <h4 style="color: var(--primary-color); margin-bottom: 15px;">شروط التسجيل والقبول (تخصص السياحة):</h4>
            
            <div class="condition-item">
              <i class="fas fa-check-circle"></i>
              <span>أن تكمل الطالبة الصف العاشر بنجاح</span>
            </div>
            <div class="condition-item">
              <i class="fas fa-check-circle"></i>
              <span>أن تكون الطالبة عمانية أو من أبناء دول مجلس التعاون لدول الخليج العربية</span>
            </div>
            <div class="condition-item">
              <i class="fas fa-check-circle"></i>
              <span>أن يكون لدى الطالبة رغبة في الالتحاق بالتعليم المهني والتقني (دبلوم السفر والسياحة)</span>
            </div>
            <div class="condition-item">
              <i class="fas fa-check-circle"></i>
              <span>أن تكون الطالبة لائقة صحياً بما يتوافق مع التخصص المطلوب</span>
            </div>
            <div class="condition-item">
              <i class="fas fa-check-circle"></i>
              <span>ألا يتجاوز عمر الطالبة المتقدم (20) عاماً</span>
            </div>
          </div>
          
          <div class="checkbox-group">
            <input type="checkbox" id="studentCommitment" required>
            <label for="studentCommitment" style="font-weight: 600; color: var(--dark-green);">
              أوافق على الالتزام بحضور الحصص الدراسية ومراعاة ضوابط الحضور والغياب، وتسليم المشاريع والواجبات في الوقت المحدد، والمحافظة على الأجهزة الإلكترونية.
            </label>
          </div>
          
          <div class="checkbox-group">
            <input type="checkbox" id="parentApproval" required>
            <label for="parentApproval" style="font-weight: 600; color: var(--dark-green);">
              أنا ولي أمر الطالبة أوافق على تسجيل ابنتي في مسار السفر والسياحة وأتعهد بمتابعتها والتزامها بجميع الشروط.
            </label>
          </div>
        </div>

        <!-- زر الإرسال -->
        <div style="text-align: center; margin-top: 30px;">
          <button type="submit" class="nav-btn register-btn" style="width: 100%; max-width: 400px; font-size: 1.2rem;">
            <i class="fas fa-paper-plane"></i> إرسال طلب التسجيل
          </button>
        </div>
      </form>
    </div>

    <!-- قسم النتيجة -->
    <div class="result-container" id="resultSection">
      <div class="result-icon">
        <i class="fas fa-clipboard-check"></i>
      </div>
      <h2 class="result-title">تم استلام طلب التسجيل</h2>
      
      <div class="result-details">
        <div class="result-item">
          <span class="result-label">رقم الطلب:</span>
          <span class="result-value" id="resultApplicationId">--</span>
        </div>
        <div class="result-item">
          <span class="result-label">اسم الطالبة:</span>
          <span class="result-value" id="resultStudentName">--</span>
        </div>
        <div class="result-item">
          <span class="result-label">الرقم المدني:</span>
          <span class="result-value" id="resultCivilId">--</span>
        </div>
        <div class="result-item">
          <span class="result-label">نقاط الميول:</span>
          <span class="result-value" id="resultTendencyPoints">--</span>
        </div>
        <div class="result-item">
          <span class="result-label">نقاط اللغة الإنجليزية:</span>
          <span class="result-value" id="resultEnglishPoints">--</span>
        </div>
        <div class="result-item">
          <span class="result-label">المجموع الكلي:</span>
          <span class="result-value" id="resultTotalPoints">--</span>
        </div>
      </div>
      
      <div class="result-status status-waiting" id="resultStatus">
        جاري مراجعة الطلب
      </div>
      
      <p class="result-note">
        <i class="fas fa-info-circle"></i> سيتم مراجعة طلبك من قبل أخصائيات التوجيه المهني، وسيتم إعلامك بالنتيجة لاحقاً.
      </p>
      
      <div style="margin-top: 30px;">
        <button class="nav-btn instructions-btn" onclick="showRegistrationForm()">
          <i class="fas fa-arrow-left"></i> العودة للتسجيل
        </button>
        <button class="nav-btn status-btn" onclick="checkApplicationStatus()">
          <i class="fas fa-search"></i> الاستعلام عن حالة الطلب
        </button>
      </div>
    </div>

    <!-- لوحة الإدارة -->
    <div class="admin-container" id="adminPanel">
      <h2 class="form-title">لوحة إدارة نظام التسجيل</h2>
      
      <div class="admin-controls">
        <div class="search-box">
          <input type="text" class="search-input" id="adminSearch" placeholder="البحث بالرقم المدني أو اسم الطالبة">
          <i class="fas fa-search search-icon"></i>
        </div>
        <button class="nav-btn" onclick="exportApplications()" style="background: var(--gradient-secondary);">
          <i class="fas fa-download"></i> تصدير البيانات
        </button>
        <button class="nav-btn" onclick="showRegistrationForm()" style="background: var(--gradient-primary);">
          <i class="fas fa-home"></i> العودة للرئيسية
        </button>
      </div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="totalApplications">0</div>
          <div class="stat-label">إجمالي الطلبات</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="acceptedApplications">0</div>
          <div class="stat-label">مقبولين</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="waitingApplications">0</div>
          <div class="stat-label">قائمة الانتظار</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="excellentEnglish">0</div>
          <div class="stat-label">ممتاز في الإنجليزية</div>
        </div>
      </div>
      
      <div style="overflow-x: auto;">
        <table class="applications-table">
          <thead>
            <tr>
              <th>م</th>
              <th>اسم الطالبة</th>
              <th>الرقم المدني</th>
              <th>الصف</th>
              <th>نقاط الميول</th>
              <th>نقاط الإنجليزية</th>
              <th>المجموع</th>
              <th>الحالة</th>
              <th>ملاحظات</th>
              <th>إجراءات</th>
            </tr>
          </thead>
          <tbody id="applicationsTableBody">
            <!-- سيتم ملؤها بالبيانات من JavaScript -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- قسم الاستعلام عن حالة الطلب -->
    <div class="registration-container" id="statusCheckSection" style="display: none;">
      <h2 class="form-title">الاستعلام عن حالة طلب التسجيل</h2>
      
      <div class="form-section" style="text-align: center;">
        <div class="form-group" style="max-width: 500px; margin: 0 auto;">
          <label class="form-label">أدخل الرقم المدني للاستعلام</label>
          <input type="text" class="form-input" id="statusCheckInput" placeholder="أدخل الرقم المدني">
        </div>
        
        <button class="nav-btn status-btn" onclick="checkStatusByCivilId()" style="margin-top: 20px; width: 200px;">
          <i class="fas fa-search"></i> بحث
        </button>
        
        <div id="statusResult" style="margin-top: 30px; display: none;">
          <!-- سيتم عرض نتيجة الاستعلام هنا -->
        </div>
      </div>
      
      <div style="text-align: center; margin-top: 30px;">
        <button class="nav-btn instructions-btn" onclick="showRegistrationForm()">
          <i class="fas fa-arrow-left"></i> العودة للتسجيل
        </button>
      </div>
    </div>

    <footer>
      <p>مدرسة خولة بنت حكيم للتعليم الأساسي - مسار السفر والسياحة</p>
      <p>أخصائيات التوجيه المهني: <strong>أ/ إيمان سعيد البهانتة</strong> | <strong>أ/ فاطمة علي بيت سعيد</strong></p>
      <p>جميع الحقوق محفوظة &copy; 2025</p>
      <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.9;">نظام ذكي لتسجيل وترشيح طالبات مسار السفر والسياحة</p>
    </footer>
  </div>

  <!-- Modal شروط التسجيل -->
  <div id="instructionsModal" class="modal" role="dialog" aria-labelledby="instructionsTitle" aria-modal="true">
    <div class="modal-content">
      <span class="close" aria-label="إغلاق النافذة">&times;</span>
      <h2 id="instructionsTitle" style="text-align:center;color:var(--dark-green);margin-bottom:20px;">شروط وشروط التسجيل في مسار السفر والسياحة</h2>
      
      <div style="background:rgba(10,92,54,0.06);padding:16px;border-radius:12px;margin-bottom:20px;border-right:4px solid var(--primary-color);">
        <h3 style="color:var(--primary-color);margin-bottom:10px;"><i class="fas fa-exclamation-circle"></i> معلومات هامة</h3>
        <p style="color:var(--text-color);font-weight:500;">يرجى الاطلاع على الشروط التالية بعناية قبل تقديم طلب التسجيل.</p>
      </div>
      
      <div style="max-height:65vh;overflow-y:auto;padding-right:8px;">
        <div class="condition-item" style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 10px; border: 1px solid rgba(0,0,0,0.08);">
          <i class="fas fa-user-graduate" style="color: var(--primary-color);"></i>
          <div>
            <div style="font-weight: 800; color: var(--dark-green); margin-bottom: 5px;">الشروط الأساسية:</div>
            <ol style="padding-right: 20px; margin-top: 10px;">
              <li>أن تكمل الطالبة الصف العاشر بنجاح</li>
              <li>أن تكون الطالبة عمانية أو من أبناء دول مجلس التعاون لدول الخليج العربية</li>
              <li>أن يكون لدى الطالبة رغبة في الالتحاق بالتعليم المهني والتقني (دبلوم السفر والسياحة)</li>
              <li>أن تكون الطالبة لائقة صحياً بما يتوافق مع التخصص المطلوب</li>
              <li>ألا يتجاوز عمر الطالبة المتقدم (20) عاماً</li>
            </ol>
          </div>
        </div>
        
        <div class="condition-item" style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 10px; border: 1px solid rgba(0,0,0,0.08);">
          <i class="fas fa-clipboard-check" style="color: var(--primary-color);"></i>
          <div>
            <div style="font-weight: 800; color: var(--dark-green); margin-bottom: 5px;">الضوابط العامة:</div>
            <ul style="padding-right: 20px; margin-top: 10px;">
              <li>استكمال متطلبات البرنامج</li>
              <li>الالتزام بحضور الحصص الدراسية ومراعاة ضوابط الحضور والغياب (وفق لائحة شؤون الطلبة)</li>
              <li>الالتزام بمواعيد تسليم المشاريع والواجبات في الوقت المحدد</li>
              <li>المحافظة على الأجهزة الإلكترونية ومراعاة ضوابط الأمن والسلامة عند استخدامها</li>
            </ul>
          </div>
        </div>
        
        <div class="condition-item" style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 10px; border: 1px solid rgba(0,0,0,0.08);">
          <i class="fas fa-chart-bar" style="color: var(--primary-color);"></i>
          <div>
            <div style="font-weight: 800; color: var(--dark-green); margin-bottom: 5px;">آلية التقييم والترشيح:</div>
            <ul style="padding-right: 20px; margin-top: 10px;">
              <li>يتم احتساب نقاط الميول من 5 أسئلة (نعم = 2، أحيانًا = 1، لا = 0)</li>
              <li>يتم تحويل درجة اللغة الإنجليزية إلى نقاط (90-100 = 5، 80-89 = 4، 70-79 = 3، 60-69 = 2، 50-59 = 1)</li>
              <li>يتم جمع نقاط الميول ونقاط اللغة الإنجليزية للحصول على المجموع الكلي</li>
              <li>يتم قبول أول 50 طالبة ذات أعلى مجموع</li>
              <li>يتم إعطاء أولوية للطالبات الحاصلات على مستوى ممتاز في اللغة الإنجليزية (90-100)</li>
              <li>يتم وضع باقي الطالبات في قائمة الانتظار</li>
            </ul>
          </div>
        </div>
        
        <div style="margin-top:20px;padding:14px;background:linear-gradient(135deg, rgba(212,175,55,0.12), rgba(46,139,87,0.08));border-radius:12px;border:1px solid rgba(212,175,55,0.25);">
          <p style="text-align:center;font-weight:800;color:var(--dark-green);margin:0;">
            نرجو لجميع الطالبات التوفيق والنجاح في مسار السفر والسياحة، ونسأل الله أن يوفق الجميع لما فيه الخير والفلاح
          </p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // البيانات والمتغيرات العامة
    let applications = JSON.parse(localStorage.getItem('tourismApplications')) || [];
    let applicationCounter = parseInt(localStorage.getItem('applicationCounter')) || 1000;
    
    // عناصر DOM
    const instructionsModal = document.getElementById("instructionsModal");
    const registrationForm = document.getElementById("registrationForm");
    const resultSection = document.getElementById("resultSection");
    const adminPanel = document.getElementById("adminPanel");
    const statusCheckSection = document.getElementById("statusCheckSection");
    
    const instructionsBtn = document.getElementById("instructionsBtn");
    const registerBtn = document.getElementById("registerBtn");
    const adminBtn = document.getElementById("adminBtn");
    const statusBtn = document.getElementById("statusBtn");
    
    const closeEls = document.getElementsByClassName("close");
    
    // العد التنازلي
    const countdownDays = document.getElementById("countdownDays");
    const countdownHours = document.getElementById("countdownHours");
    const countdownMinutes = document.getElementById("countdownMinutes");
    const countdownSeconds = document.getElementById("countdownSeconds");
    
    // عناصر النموذج
    const studentRegistrationForm = document.getElementById("studentRegistrationForm");
    const certificateFile = document.getElementById("certificateFile");
    const fileName = document.getElementById("fileName");
    
    // عناصر النتيجة
    const resultApplicationId = document.getElementById("resultApplicationId");
    const resultStudentName = document.getElementById("resultStudentName");
    const resultCivilId = document.getElementById("resultCivilId");
    const resultTendencyPoints = document.getElementById("resultTendencyPoints");
    const resultEnglishPoints = document.getElementById("resultEnglishPoints");
    const resultTotalPoints = document.getElementById("resultTotalPoints");
    const resultStatus = document.getElementById("resultStatus");
    
    // عناصر لوحة الإدارة
    const totalApplications = document.getElementById("totalApplications");
    const acceptedApplications = document.getElementById("acceptedApplications");
    const waitingApplications = document.getElementById("waitingApplications");
    const excellentEnglish = document.getElementById("excellentEnglish");
    const applicationsTableBody = document.getElementById("applicationsTableBody");
    const adminSearch = document.getElementById("adminSearch");
    
    // تاريخ بداية ونهاية التسجيل
    const registrationEndDate = new Date('2026-02-26T23:59:59');
    
    // تهيئة العد التنازلي
    function updateCountdown() {
      const now = new Date().getTime();
      const distance = registrationEndDate - now;
      
      if (distance < 0) {
        countdownDays.textContent = "00";
        countdownHours.textContent = "00";
        countdownMinutes.textContent = "00";
        countdownSeconds.textContent = "00";
        return;
      }
      
      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((distance % (1000 * 60)) / 1000);
      
      countdownDays.textContent = days.toString().padStart(2, '0');
      countdownHours.textContent = hours.toString().padStart(2, '0');
      countdownMinutes.textContent = minutes.toString().padStart(2, '0');
      countdownSeconds.textContent = seconds.toString().padStart(2, '0');
    }
    
    // تحديث العد التنازلي كل ثانية
    setInterval(updateCountdown, 1000);
    updateCountdown(); // التشغيل الأولي
    
    // عرض نموذج التسجيل
    function showRegistrationForm() {
      registrationForm.classList.add('active');
      resultSection.classList.remove('active');
      adminPanel.classList.remove('active');
      statusCheckSection.style.display = 'none';
      studentRegistrationForm.reset();
      fileName.textContent = 'لم يتم اختيار ملف';
    }
    
    // عرض نتيجة التسجيل
    function showResultSection() {
      registrationForm.classList.remove('active');
      resultSection.classList.add('active');
      adminPanel.classList.remove('active');
      statusCheckSection.style.display = 'none';
    }
    
    // عرض لوحة الإدارة
    function showAdminPanel() {
      const password = prompt("أدخل كلمة المرور للوصول إلى لوحة الإدارة:");
      if (password === "7211") {
        registrationForm.classList.remove('active');
        resultSection.classList.remove('active');
        adminPanel.classList.add('active');
        statusCheckSection.style.display = 'none';
        updateAdminPanel();
      } else {
        alert("كلمة المرور غير صحيحة!");
      }
    }
    
    // عرض قسم الاستعلام
    function showStatusCheck() {
      registrationForm.classList.remove('active');
      resultSection.classList.remove('active');
      adminPanel.classList.remove('active');
      statusCheckSection.style.display = 'block';
    }
    
    // تحديث اسم الملف المرفوع
    certificateFile.addEventListener('change', function(e) {
      if (this.files && this.files[0]) {
        fileName.textContent = this.files[0].name;
      } else {
        fileName.textContent = 'لم يتم اختيار ملف';
      }
    });
    
    // تحويل درجة الإنجليزية إلى نقاط
    function calculateEnglishPoints(grade) {
      if (grade >= 90 && grade <= 100) return 5;
      if (grade >= 80 && grade <= 89) return 4;
      if (grade >= 70 && grade <= 79) return 3;
      if (grade >= 60 && grade <= 69) return 2;
      if (grade >= 50 && grade <= 59) return 1;
      return 0;
    }
    
    // حساب نقاط الميول
    function calculateTendencyPoints(formData) {
      let total = 0;
      for (let i = 1; i <= 5; i++) {
        total += parseInt(formData.get(`q${i}`)) || 0;
      }
      return total;
    }
    
    // تحديد حالة الطلب (مقبول/انتظار)
    function determineApplicationStatus(totalPoints, englishGrade, currentApplications) {
      // أولوية للغة الإنجليزية الممتازة
      if (englishGrade >= 90) {
        return 'مقبول';
      }
      
      // إذا وصلنا للحد الأقصى (50 مقبول)
      const acceptedCount = currentApplications.filter(app => app.status === 'مقبول').length;
      if (acceptedCount >= 50) {
        return 'قائمة الانتظار';
      }
      
      // إذا كان المجموع عالي بما يكفي
      const sortedApplications = [...currentApplications].sort((a, b) => b.totalPoints - a.totalPoints);
      if (sortedApplications.length < 50 || totalPoints >= sortedApplications[Math.min(49, sortedApplications.length-1)].totalPoints) {
        return 'مقبول';
      }
      
      return 'قائمة الانتظار';
    }
    
    // معالجة تقديم النموذج
    studentRegistrationForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const formData = new FormData(this);
      
      // جمع البيانات
      const applicationData = {
        id: applicationCounter++,
        studentName: document.getElementById('studentName').value,
        studentGrade: document.getElementById('studentGrade').value,
        civilId: document.getElementById('civilId').value,
        studentPhone: document.getElementById('studentPhone').value,
        parentPhone: document.getElementById('parentPhone').value,
        residentialArea: document.getElementById('residentialArea').value,
        parentName: document.getElementById('parentName').value,
        parentRelation: document.getElementById('parentRelation').value,
        englishGrade: parseInt(document.getElementById('englishGrade').value),
        tendencyPoints: calculateTendencyPoints(formData),
        submissionDate: new Date().toISOString(),
        certificateFile: certificateFile.files[0] ? certificateFile.files[0].name : null
      };
      
      // حساب النقاط
      applicationData.englishPoints = calculateEnglishPoints(applicationData.englishGrade);
      applicationData.totalPoints = applicationData.tendencyPoints + applicationData.englishPoints;
      
      // تحديد الحالة
      applicationData.status = determineApplicationStatus(applicationData.totalPoints, applicationData.englishGrade, applications);
      applicationData.notes = applicationData.englishGrade >= 90 ? 'أولوية للغة الإنجليزية الممتازة' : '';
      
      // إضافة الطلب
      applications.push(applicationData);
      
      // حفظ في localStorage
      localStorage.setItem('tourismApplications', JSON.stringify(applications));
      localStorage.setItem('applicationCounter', applicationCounter.toString());
      
      // عرض النتيجة
      displayApplicationResult(applicationData);
      
      // إعادة تعيين النموذج
      this.reset();
      fileName.textContent = 'لم يتم اختيار ملف';
    });
    
    // عرض نتيجة الطلب
    function displayApplicationResult(application) {
      resultApplicationId.textContent = application.id;
      resultStudentName.textContent = application.studentName;
      resultCivilId.textContent = application.civilId;
      resultTendencyPoints.textContent = application.tendencyPoints;
      resultEnglishPoints.textContent = application.englishPoints;
      resultTotalPoints.textContent = application.totalPoints;
      
      // تحديث حالة النتيجة
      if (application.status === 'مقبول') {
        resultStatus.textContent = 'تم استلام الطلب - جاري المراجعة';
        resultStatus.className = 'result-status status-accepted';
      } else {
        resultStatus.textContent = 'تم استلام الطلب - جاري المراجعة';
        resultStatus.className = 'result-status status-waiting';
      }
      
      showResultSection();
    }
    
    // تحديث لوحة الإدارة
    function updateAdminPanel() {
      // تحديث الإحصائيات
      totalApplications.textContent = applications.length;
      
      const accepted = applications.filter(app => app.status === 'مقبول').length;
      const waiting = applications.filter(app => app.status === 'قائمة الانتظار').length;
      const excellent = applications.filter(app => app.englishGrade >= 90).length;
      
      acceptedApplications.textContent = accepted;
      waitingApplications.textContent = waiting;
      excellentEnglish.textContent = excellent;
      
      // تحديث الجدول
      updateApplicationsTable();
    }
    
    // تحديث جدول الطلبات
    function updateApplicationsTable(filter = '') {
      applicationsTableBody.innerHTML = '';
      
      let filteredApplications = applications;
      if (filter) {
        filteredApplications = applications.filter(app => 
          app.civilId.includes(filter) || 
          app.studentName.includes(filter)
        );
      }
      
      // ترتيب حسب المجموع الكلي (تنازلي)
      filteredApplications.sort((a, b) => b.totalPoints - a.totalPoints);
      
      filteredApplications.forEach((app, index) => {
        const row = document.createElement('tr');
        
        // تحديد لون الصف للغة الإنجليزية الممتازة
        if (app.englishGrade >= 90) {
          row.style.backgroundColor = 'rgba(70, 130, 180, 0.05)';
        }
        
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${app.studentName}</td>
          <td>${app.civilId}</td>
          <td>${app.studentGrade}</td>
          <td>${app.tendencyPoints}</td>
          <td>${app.englishPoints}</td>
          <td><strong>${app.totalPoints}</strong></td>
          <td>
            <span class="status-badge ${app.status === 'مقبول' ? 'badge-accepted' : 'badge-waiting'}">
              ${app.status}
            </span>
            ${app.englishGrade >= 90 ? '<span class="status-badge badge-excellent" style="margin-right: 5px;">ممتاز إنجليزي</span>' : ''}
          </td>
          <td>${app.notes || '-'}</td>
          <td>
            <button onclick="toggleApplicationStatus(${app.id})" style="background: var(--primary-color); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
              تغيير الحالة
            </button>
          </td>
        `;
        
        applicationsTableBody.appendChild(row);
      });
    }
    
    // تغيير حالة الطلب
    function toggleApplicationStatus(id) {
      const appIndex = applications.findIndex(app => app.id === id);
      if (appIndex !== -1) {
        applications[appIndex].status = applications[appIndex].status === 'مقبول' ? 'قائمة الانتظار' : 'مقبول';
        localStorage.setItem('tourismApplications', JSON.stringify(applications));
        updateAdminPanel();
      }
    }
    
    // تصدير البيانات
    function exportApplications() {
      const dataStr = JSON.stringify(applications, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const exportFileDefaultName = `طلبات_مسار_السفر_والسياحة_${new Date().toISOString().slice(0,10)}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
    }
    
    // البحث في لوحة الإدارة
    adminSearch.addEventListener('input', function() {
      updateApplicationsTable(this.value);
    });
    
    // الاستعلام عن حالة الطلب بالرقم المدني
    function checkApplicationStatus() {
      showStatusCheck();
    }
    
    function checkStatusByCivilId() {
      const civilId = document.getElementById('statusCheckInput').value;
      const application = applications.find(app => app.civilId === civilId);
      
      const statusResult = document.getElementById('statusResult');
      
      if (application) {
        let statusHTML = `
          <div class="result-details">
            <div class="result-item">
              <span class="result-label">اسم الطالبة:</span>
              <span class="result-value">${application.studentName}</span>
            </div>
            <div class="result-item">
              <span class="result-label">رقم الطلب:</span>
              <span class="result-value">${application.id}</span>
            </div>
            <div class="result-item">
              <span class="result-label">تاريخ التقديم:</span>
              <span class="result-value">${new Date(application.submissionDate).toLocaleDateString('ar-OM')}</span>
            </div>
            <div class="result-item">
              <span class="result-label">المجموع الكلي:</span>
              <span class="result-value">${application.totalPoints} نقطة</span>
            </div>
            <div class="result-item">
              <span class="result-label">الحالة:</span>
              <span class="result-value" style="font-weight: 900; color: ${application.status === 'مقبول' ? 'var(--secondary-color)' : 'var(--gold-color)'}">
                ${application.status === 'مقبول' ? 'جاري المراجعة' : 'جاري المراجعة'}
              </span>
            </div>
          </div>
          <p class="result-note" style="margin-top: 20px;">
            <i class="fas fa-info-circle"></i> سيتم إعلامك بالنتيجة النهائية بعد انتهاء فترة التسجيل ومراجعة جميع الطلبات.
          </p>
        `;
        
        statusResult.innerHTML = statusHTML;
        statusResult.style.display = 'block';
      } else {
        statusResult.innerHTML = `
          <div style="text-align: center; padding: 20px; background: rgba(230, 57, 70, 0.1); border-radius: 10px; border: 1px solid rgba(230, 57, 70, 0.3);">
            <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: var(--accent-color); margin-bottom: 10px;"></i>
            <h3 style="color: var(--accent-color);">لم يتم العثور على طلب</h3>
            <p>الرقم المدني المدخل غير مسجل في النظام. يرجى التأكد من الرقم أو تقديم طلب جديد.</p>
          </div>
        `;
        statusResult.style.display = 'block';
      }
    }
    
    // معالجة الأحداث
    instructionsBtn.onclick = () => {
      instructionsModal.style.display = "block";
      document.body.style.overflow = "hidden";
    };
    
    registerBtn.onclick = showRegistrationForm;
    adminBtn.onclick = showAdminPanel;
    statusBtn.onclick = showStatusCheck;
    
    for (let i = 0; i < closeEls.length; i++) {
      closeEls[i].onclick = function() {
        instructionsModal.style.display = "none";
        document.body.style.overflow = "auto";
      };
    }
    
    window.onclick = (e) => {
      if (e.target === instructionsModal) {
        instructionsModal.style.display = "none";
        document.body.style.overflow = "auto";
      }
    };
    
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        instructionsModal.style.display = "none";
        document.body.style.overflow = "auto";
      }
    });
    
    // التهيئة الأولية
    function init() {
      showRegistrationForm();
      updateCountdown();
    }
    
    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
